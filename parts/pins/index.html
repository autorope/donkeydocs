<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Pins - Donkey Car</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Pins";
        var mkdocs_page_input_path = "parts/pins.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Donkey Car
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/build_hardware/">Build a car.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/install_software/">Install the software.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/create_application/">Create Donkeycar App.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/calibrate/">Calibrate steering and throttle.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/get_driving/">Get driving.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/train_autopilot/">Create an autopilot.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../utility/ui/">Donkey UI.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/deep_learning/simulator/">Donkey Simulator.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/deep_learning/virtual_race_league/">Virtual Race League.</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/deep_learning/mobile_app/">Mobile app</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Parts</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../actuators/">Actuators</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cameras/">Cameras</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../controllers/">Controllers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../odometry/">Odometry/encoders</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../keras/">Keras</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../stores/">Stores</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fastai/">Fastai</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../imu/">IMU</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/path_follow/path_follow/">GPS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../lidar/">Lidar</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oled/">OLED</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Pins</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#types-of-pins">Types of Pins</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pin-providers">Pin Providers</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#pca9685">PCA9685</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#rpi_gpio">RPI_GPIO</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pigpio">PIGPIO</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#installing-and-starting-pigpio">Installing and Starting PiGPIO</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#generating-pwm-from-the-jetson-nano">Generating PWM from the Jetson Nano</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#configure-jetson-expansion-header-for-pwm">Configure Jetson Expansion Header for PWM</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../voice_control/">Voice Control</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../stop_sign_detection/">Stop Sign Detection</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Utilities</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../utility/donkey/">donkey</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../utility/ui/">Donkey UI.</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Developer Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../dev_guide/contribute/">Contribute</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dev_guide/tests/">Tests</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../dev_guide/model/">Create your own model</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Cars</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../cars/supported_cars/">Supported Cars</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cars/roll_your_own/">Roll Your Own</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Support</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../support/faq/">FAQ</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../support/legacy/">Legacy</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Donkey Car</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Parts</li>
      <li class="breadcrumb-item active">Pins</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/autorope/donkeydocs/edit/master/docs/parts/pins.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="pin-specifiers">Pin Specifiers</h1>
<p>Control signals are send and received by pins on the Raspberry Pi, Jetson Nano and connected peripherals, like the PCA9685 Servo controller.  Starting wit version 5.x, Donkeycar uses 'pin specs' to specify pins including various configuration that is specific to the underlying hardware or library implementation.  This allows use to make the underlying logic, like how a motor controller takes throttle values and outputs them to the motor, more independent of the particular hardware or library used to generate the signals.</p>
<h2 id="types-of-pins">Types of Pins</h2>
<p>PWM pins generate a square wave, sometimes called a PWM pulse.  This is used to control servo motors, electronic speed controllers, and LEDs.</p>
<p>TTL Output pins can generate either a high value (1) or a low value (0)</p>
<p>TTL Input pins read values as either high (1) or low (0)</p>
<h2 id="pin-providers">Pin Providers</h2>
<p>Donkeycar supports several technologies for specifying pins.  Pins are specified as a string that identifies the provider, the pin number and any techology specific configuration.</p>
<h4 id="pca9685">PCA9685</h4>
<p>The PCA9685 Servo controller supports 16 PWM and TTL output pins.  The PCA9685 can only output signals; it does not support input pins.  The pin specifier for a PCA9685 pin includes:</p>
<ul>
<li>the I2C bus to which the PCA9685 is attached</li>
<li>the address in hex of the PCA9685 on the I2C bus</li>
<li>the channel number 0.15</li>
</ul>
<p>For example, <code>"PCA9685.1:40.13"</code> specifies channel 13 on the PCA9685 on I2C bus 1 at address 0x40.</p>
<p>For example, <code>"PCA9685.0:60.1"</code> specified channel 1 on the PCA9685 on I2C bus 0 at address 0x60</p>
<h4 id="rpi_gpio">RPI_GPIO</h4>
<p>Donkeycar installs the RPi.GPIO library on the RaspberryPi in the default installation.  The Jetson.GPIO library is compatible library installed by default on the Jetson Nano.  Both of these libaries work is a similar fashion to support PWM, input and output pins on the 40 pin GPIO bus of the RaspberryPi or Jetson Nano respectively.  The pin specifier includes:</p>
<ul>
<li>The pin addressing scheme</li>
<li>"BOARD" indicates the pin number is based on the pin numbers, 0 to 39, printed on the RaspberryPi/Jetson Nano circuit board.</li>
<li>"BCM" indicates the pin number is based on the Broadcom GPIO number scheme implemented in the RaspberryPi.  This scheme is emulated in the Jetson library, so "BCM" pin numbers can be used on the Jetson. </li>
<li>The pin number, which depends upon the pin addressing scheme.</li>
</ul>
<p>See details of the RaspberryPi 40 pin header here:  https://www.raspberrypi.com/documentation/computers/os.html#gpio-and-the-40-pin-header</p>
<p>Jetson Nano 40 pin header uses the same board numbering scheme, although the header is physically flipped on the board, so pay attention to the numbers printed on the board.  The Jetson Nano only supports 2 PWM pins and these must be enabled.  See <a href="#generating-pwm-from-the-jetson-nano">Generating PWM from the Jetson Nano</a></p>
<p>For example, <code>"RPI_GPIO.BOARD.33"</code> specifies board pin 33 using the Rpi.GPIO library.</p>
<p>For example, <code>"RPI_GPIO.BCM.13"</code> specifies Broadcom GPIO-13 using the Rpi.GPIO library.  If you look at the header diagram linked above you will notice that this is the same physical pin as "RPI_GPIO.BOARD.33"; it is a synonymn for physical pin 33.  </p>
<p>When using the RPI_GPIO pin provider, you can choose to use the BOARD or BCM pin schemes, but all pins must use the same pin scheme.  You cannot mix pin schemes.</p>
<h4 id="pigpio">PIGPIO</h4>
<p>RaspberryPi users can optionally install the PiGPIO library and daemon to manage the pins on the 40 pin GPIO header.  Note that this library does NOT work on the Jetson Nano.  The library support PWM, Input and Output pins.</p>
<h5 id="installing-and-starting-pigpio">Installing and Starting PiGPIO</h5>
<ul>
<li>Install the system daemon</li>
</ul>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install pigpio
</code></pre>
<ul>
<li>Install python support (with donkey environment activated)</li>
</ul>
<pre><code class="language-bash">pip install pigpio
</code></pre>
<ul>
<li>Start the daemon</li>
</ul>
<pre><code class="language-bash">sudo systemctl start pigpiod
</code></pre>
<ul>
<li>Enable the daemon on startup</li>
</ul>
<pre><code>sudo systemctl enable pigpiod
</code></pre>
<p>The PIGPIO pin specifier includes:
- "BCM"  PiGPIO used Broadcom (BCM) pin numbering scheme exclusively, so that is baked into the pin specifier.
- The BCM pin number</p>
<p>For example, <code>"PIGPIO.BCM.13"</code> specifies Broadcom GPIO-13.  As discussed above and shown in the linked header diagram, this is exposed on board pin 33.</p>
<h2 id="generating-pwm-from-the-jetson-nano">Generating PWM from the Jetson Nano</h2>
<p>Both the Jetson Nano and RaspberryPi4 support two hardware PWM pins.  On the Jetson Nano, these must be configured.</p>
<h4 id="configure-jetson-expansion-header-for-pwm">Configure Jetson Expansion Header for PWM</h4>
<ul>
<li>
<p>ssh into the donkeycar and run this command <code>sudo /opt/nvidia/jetson-io/jetson-io.py</code>.  It should show the Jetson Expansion Header Tool that allows you to change GPIO pin functions (see below).</p>
</li>
<li>
<p>If your Jetson expansion header configuration does not show any PWM pins, then you will need to enable them.</p>
</li>
</ul>
<pre><code>---
     =================== Jetson Expansion Header Tool ===================
     |                                                                    |
     |                                                                    |
     |                        3.3V ( 1)  ( 2) 5V                          |
     |                        i2c2 ( 3)  ( 4) 5V                          |
     |                        i2c2 ( 5)  ( 6) GND                         |
     |                      unused ( 7)  ( 8) uartb                       |
     |                         GND ( 9)  (10) uartb                       |
     |                      unused (11)  (12) unused                      |
     |                      unused (13)  (14) GND                         |
     |                      unused (15)  (16) unused                      |
     |                        3.3V (17)  (18) unused                      |
     |                      unused (19)  (20) GND                         |
     |                      unused (21)  (22) unused                      |
     |                      unused (23)  (24) unused                      |
     |                         GND (25)  (26) unused                      |
     |                        i2c1 (27)  (28) i2c1                        |
     |                      unused (29)  (30) GND                         |
     |                      unused (31)  (32) unused                      |
     |                      unused (33)  (34) GND                         |
     |                      unused (35)  (36) unused                      |
     |                      unused (37)  (38) unused                      |
     |                         GND (39)  (40) unused                      |
     |                                                                    |
      ====================================================================
---
</code></pre>
<p>Choose <code>Configure the 40 pin expansion header</code> to activate pwm0 and pwm2:</p>
<pre><code>---
     =================== Jetson Expansion Header Tool ===================
     |                                                                    |
     |                                                                    |
     |                        3.3V ( 1)  ( 2) 5V                          |
     |                        i2c2 ( 3)  ( 4) 5V                          |
     |                        i2c2 ( 5)  ( 6) GND                         |
     |                      unused ( 7)  ( 8) uartb                       |
     |                         GND ( 9)  (10) uartb                       |
     |                      unused (11)  (12) unused                      |
     |                      unused (13)  (14) GND                         |
     |                      unused (15)  (16) unused                      |
     |                        3.3V (17)  (18) unused                      |
     |                      unused (19)  (20) GND                         |
     |                      unused (21)  (22) unused                      |
     |                      unused (23)  (24) unused                      |
     |                         GND (25)  (26) unused                      |
     |                        i2c1 (27)  (28) i2c1                        |
     |                      unused (29)  (30) GND                         |
     |                      unused (31)  (32) pwm0                        |
     |                        pwm2 (33)  (34) GND                         |
     |                      unused (35)  (36) unused                      |
     |                      unused (37)  (38) unused                      |
     |                         GND (39)  (40) unused                      |
     |                                                                    |
      ====================================================================
---
</code></pre>
<p>After enabling, pwm0 is board pin-32 and pwm2 is board pin-33.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../oled/" class="btn btn-neutral float-left" title="OLED"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../voice_control/" class="btn btn-neutral float-right" title="Voice Control">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/autorope/donkeydocs/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../oled/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../voice_control/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
